---
output:
  pdf_document: default
  html_document: default
---


```{r}

library(ggplot2)
library(reshape2)


data <- read.csv("knapsack_results_250base_inc20.csv")
filtered_data <- subset(data, !(generations %in% c(5,10,15,20,25,30,35,40,45)))

# boxplot
ggplot(data, aes(x = as.factor(generations), y = best_score)) +
  geom_boxplot() +
  labs(title = "Boxplot of Best Scores by Generations",
       x = "Generations",
       y = "Best Score") +
  theme_minimal()



ggplot(filtered_data, aes(x = as.factor(generations), y = best_score)) +
  geom_boxplot() +
  labs(title = "Filtered Boxplot of Best Scores by Generations",
       x = "Generations",
       y = "Best Score") +
  theme_minimal()


```


```{r}

# p values

wilcox_results <- pairwise.wilcox.test(data$best_score, 
                                      as.factor(data$generations),
                                      p.adjust.method = "bonferroni")
#print("Pairwise Wilcoxon Test Results (All Data):")
#print(wilcox_results)

matrix_results <- wilcox_results$p.value 

library(knitr)
library(kableExtra)

# Extract Wilcoxon test results as a matrix
matrix_results <- wilcox_results$p.value

# Replace NA values with "-" for better readability
matrix_results[is.na(matrix_results)] <- "-"

# Format as a lower triangular table
kable(matrix_results, format = "html", escape = FALSE) %>%
  kable_styling(full_width = FALSE, font_size = 10) %>%
  scroll_box(width = "100%", height = "400px")


# Convert Wilcoxon test results into a data frame
wilcox_matrix <- as.data.frame(as.table(wilcox_results$p.value))

# Rename columns for clarity
colnames(wilcox_matrix) <- c("Gen1", "Gen2", "P_Value")

# Remove NA values
wilcox_matrix <- na.omit(wilcox_matrix)

# Convert generations to numeric
wilcox_matrix$Gen1 <- as.numeric(as.character(wilcox_matrix$Gen1))
wilcox_matrix$Gen2 <- as.numeric(as.character(wilcox_matrix$Gen2))

# Create the heatmap
ggplot(wilcox_matrix, aes(x = factor(Gen1, levels = unique(wilcox_matrix$Gen1)), 
                          y = factor(Gen2, levels = unique(wilcox_matrix$Gen2)), 
                          fill = -log10(P_Value))) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "blue", high = "red", name = "-log10(p-value)") +
  labs(title = "Pairwise Wilcoxon Test Heatmap",
       x = "Generations",
       y = "Generations") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5))
```

